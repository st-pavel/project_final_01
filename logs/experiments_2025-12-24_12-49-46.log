12:49:46 - INFO - Старт сессии
12:51:05 - INFO - Интерактивный отчет D-Tale доступен по ссылке: http://0.0.0.0:40000/dtale/main/1
12:51:07 - INFO - 
=================================================================
MODEL: LinearRegression (baseline)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           260,093.71 |           258,702.98
MSE        |      164,343,123,678 |      161,147,514,384
R2         |               0.3019 |               0.3059
=================================================================

12:51:17 - INFO - Оптимальное количество признаков по RFECV: 16
12:51:17 - INFO - Отобранные признаки: ['baths', 'zipcode', 'latitude', 'longitude', 'sqft', 'stories', 'beds', 'lotsize', 'age', 'rating_mean', 'distance_mean', 'schools_count', 'status_for sale', 'propertyType_coop', 'propertyType_land', 'propertyType_single family']
12:51:17 - INFO - 
=================================================================
MODEL: LinearRegression (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           273,048.10 |           271,611.81
MSE        |      179,274,918,370 |      175,822,519,868
R2         |               0.2385 |               0.2427
=================================================================

12:51:18 - INFO - 
=================================================================
MODEL: DecisionTreeRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |            66,382.75 |           172,798.91
MSE        |       31,701,211,805 |      116,812,000,156
R2         |               0.8653 |               0.4969
=================================================================

12:51:23 - INFO - Выбрана оптимальная глубина дерева (с учетом допуска): 13 (R2: 0.631)
12:51:24 - INFO - 
=================================================================
MODEL: DecisionTreeRegressor (Elbow method depth = 13)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           175,869.82 |           189,885.30
MSE        |       89,752,527,129 |      107,069,066,757
R2         |               0.6188 |               0.5388
=================================================================

12:51:30 - INFO - 
=================================================================
MODEL: RandomForestRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           151,322.21 |           170,934.62
MSE        |       68,493,243,719 |       89,784,069,197
R2         |               0.7091 |               0.6133
=================================================================

12:55:34 - INFO - 
=================================================================
MODEL: GradientBoostingRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           133,067.43 |           161,012.67
MSE        |       56,824,840,685 |       83,930,498,797
R2         |               0.7586 |               0.6385
=================================================================

12:55:38 - INFO - 
=================================================================
MODEL: CatBoostRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           172,927.94 |           174,533.88
MSE        |       89,550,052,377 |       91,462,894,845
R2         |               0.6196 |               0.6060
=================================================================

12:55:43 - INFO - 
=================================================================
MODEL: CatBoostRegressor (All features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           126,097.26 |           129,294.69
MSE        |       52,384,738,276 |       55,748,715,395
R2         |               0.7775 |               0.7599
=================================================================

12:55:45 - INFO - Отобрано признаков с помощью CatBoost: 30
12:55:45 - INFO - Список признаков: ['baths', 'zipcode', 'latitude', 'longitude', 'sqft', 'stories', 'beds', 'lotsize', 'age', 'rating_mean', 'distance_mean', 'schools_count', 'status_for sale', 'status_foreclosure', 'status_new construction', 'status_other', 'propertyType_coop', 'propertyType_high rise', 'propertyType_land', 'propertyType_multi family', 'propertyType_other', 'propertyType_single family', 'propertyType_townhouse', 'propertyType_traditional', 'heating_central', 'heating_forced air', 'heating_other', 'cooling_central air', 'cooling_cooling', 'parking_detached']
12:55:49 - INFO - 
=================================================================
MODEL: CatBoostRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           125,728.43 |           128,855.11
MSE        |       52,165,331,701 |       55,635,568,867
R2         |               0.7784 |               0.7604
=================================================================

12:56:00 - INFO - 
=================================================================
MODEL: RandomForestRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           140,327.42 |           152,104.47
MSE        |       55,944,428,080 |       69,311,937,120
R2         |               0.7624 |               0.7015
=================================================================

13:03:56 - INFO - 
=================================================================
MODEL: GradientBoostingRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           123,205.82 |           131,905.48
MSE        |       47,374,270,490 |       57,217,097,785
R2         |               0.7988 |               0.7536
=================================================================

13:03:58 - INFO - 
=================================================================
MODEL: XGBRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           123,914.61 |           128,444.90
MSE        |       51,326,955,548 |       55,890,678,586
R2         |               0.7820 |               0.7593
=================================================================

13:18:56 - INFO - 
=================================================================
MODEL: PIPELINE GradientBoostingRegressor
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           103,607.35 |           112,982.04
MSE        |       35,635,288,246 |       45,235,731,793
R2         |               0.8462 |               0.8049
=================================================================

13:19:44 - INFO - 
Лучшие гиперпараметры (Optuna): {'n_estimators': 1969, 'max_depth': 6, 'learning_rate': 0.06828688381154933, 'subsample': 0.8639469175076524, 'colsample_bytree': 0.6422456483868698}
13:19:44 - INFO - 
Лучший R2 на тесте подбора гиперпараметров (Optuna): 0.7759674476052199
13:19:54 - INFO - 
=================================================================
MODEL: PIPELINE OPTUNA TUNED XGBOOST
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |            90,085.61 |           105,844.30
MSE        |       27,339,399,173 |       41,393,875,603
R2         |               0.8820 |               0.8214
=================================================================

13:21:54 - INFO - 
=================================================================
MODEL: PIPELINE STACKING RF CatBoost(GPU) RIDGE
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           115,779.33 |           120,098.26
MSE        |       44,722,406,432 |       49,404,380,347
R2         |               0.8070 |               0.7869
=================================================================

13:22:27 - INFO - 
=================================================================
MODEL: PIPELINE STACKING RF+histGB+Ridge
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           127,296.01 |           129,881.71
MSE        |       52,853,531,959 |       55,381,227,341
R2         |               0.7719 |               0.7611
=================================================================

13:26:32 - INFO - 
=================================================================
MODEL: PIPELINE STACKING XGB deep + XGB shallow
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |            70,710.54 |            99,371.47
MSE        |       16,813,305,440 |       38,379,763,666
R2         |               0.9274 |               0.8344
=================================================================

13:26:34 - INFO - Завершение сессии
