20:56:05 - INFO - Старт сессии
20:56:05 - INFO - 
=================================================================
SYSTEM CONFIGURATION
-----------------------------------------------------------------
Date:   2025-12-24 20:56:05
OS:     Linux 6.14.0-37-generic (#37~24.04.1-Ubuntu SMP PREEMPT_DYNAMIC Thu Nov 20 10:25:38 UTC 2)
Python: 3.12.3
CPU:    x86_64 (22 cores)
RAM:    93.91 GB
GPU:    NVIDIA GeForce RTX 4060 Laptop GPU (7.62 GB VRAM)
=================================================================

20:56:08 - INFO - DATASET LOADED: ./data/data.csv
SHAPE: 377185 rows x 18 columns | MEMORY: 595.6 MB
MISSING: 1869153 cells (27.5% of all values)
20:57:24 - INFO - Интерактивный отчет D-Tale доступен по ссылке: http://0.0.0.0:40000/dtale/main/1
20:57:26 - INFO - 
=================================================================
MODEL: LinearRegression (baseline)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           260,093.71 |           258,702.98
MSE        |      164,343,123,678 |      161,147,514,384
R2         |               0.3019 |               0.3059
-----------------------------------------------------------------
Time       |                                    0.03 sec
=================================================================

20:57:36 - INFO - Оптимальное количество признаков по RFECV: 16
20:57:36 - INFO - Отобранные признаки: ['baths', 'zipcode', 'latitude', 'longitude', 'sqft', 'stories', 'beds', 'lotsize', 'age', 'rating_mean', 'distance_mean', 'schools_count', 'status_for sale', 'propertyType_coop', 'propertyType_land', 'propertyType_single family']
20:57:36 - INFO - 
=================================================================
MODEL: LinearRegression (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           273,048.10 |           271,611.81
MSE        |      179,274,918,370 |      175,822,519,868
R2         |               0.2385 |               0.2427
-----------------------------------------------------------------
Time       |                                    0.04 sec
=================================================================

20:57:37 - INFO - 
=================================================================
MODEL: DecisionTreeRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |            66,382.75 |           172,798.91
MSE        |       31,701,211,805 |      116,812,000,156
R2         |               0.8653 |               0.4969
-----------------------------------------------------------------
Time       |                                    0.92 sec
=================================================================

20:57:42 - INFO - Выбрана оптимальная глубина дерева (с учетом допуска): 13 (R2: 0.631)
20:57:43 - INFO - 
=================================================================
MODEL: DecisionTreeRegressor (Elbow method depth = 13)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           175,869.82 |           189,885.30
MSE        |       89,752,527,129 |      107,069,066,757
R2         |               0.6188 |               0.5388
-----------------------------------------------------------------
Time       |                                    0.51 sec
=================================================================

20:57:49 - INFO - 
=================================================================
MODEL: RandomForestRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           151,322.21 |           170,934.62
MSE        |       68,493,243,719 |       89,784,069,197
R2         |               0.7091 |               0.6133
-----------------------------------------------------------------
Time       |                                    6.46 sec
=================================================================

20:57:53 - INFO - 
=================================================================
MODEL: HistGradientBoostingRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           199,103.78 |           197,921.01
MSE        |      111,309,408,475 |      109,738,343,654
R2         |               0.5272 |               0.5273
-----------------------------------------------------------------
Time       |                                    4.32 sec
=================================================================

20:57:58 - INFO - 
=================================================================
MODEL: CatBoostRegressor (Top-16 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           172,927.94 |           174,533.88
MSE        |       89,550,052,377 |       91,462,894,845
R2         |               0.6196 |               0.6060
-----------------------------------------------------------------
Time       |                                    4.23 sec
=================================================================

20:58:02 - INFO - 
=================================================================
MODEL: CatBoostRegressor (All features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           126,097.26 |           129,294.69
MSE        |       52,384,738,276 |       55,748,715,395
R2         |               0.7775 |               0.7599
-----------------------------------------------------------------
Time       |                                    4.28 sec
=================================================================

20:58:04 - INFO - Отобрано признаков с помощью CatBoost: 30
20:58:04 - INFO - Список признаков: ['baths', 'zipcode', 'latitude', 'longitude', 'sqft', 'stories', 'beds', 'lotsize', 'age', 'rating_mean', 'distance_mean', 'schools_count', 'status_for sale', 'status_foreclosure', 'status_new construction', 'status_other', 'propertyType_coop', 'propertyType_high rise', 'propertyType_land', 'propertyType_multi family', 'propertyType_other', 'propertyType_single family', 'propertyType_townhouse', 'propertyType_traditional', 'heating_central', 'heating_forced air', 'heating_other', 'cooling_central air', 'cooling_cooling', 'parking_detached']
20:58:08 - INFO - 
=================================================================
MODEL: CatBoostRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           125,728.43 |           128,855.11
MSE        |       52,165,331,701 |       55,635,568,867
R2         |               0.7784 |               0.7604
-----------------------------------------------------------------
Time       |                                    4.22 sec
=================================================================

20:58:19 - INFO - 
=================================================================
MODEL: RandomForestRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           140,327.42 |           152,104.47
MSE        |       55,944,428,080 |       69,311,937,120
R2         |               0.7624 |               0.7015
-----------------------------------------------------------------
Time       |                                   10.77 sec
=================================================================

20:58:24 - INFO - 
=================================================================
MODEL: HistGradientBoostingRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           162,462.83 |           161,984.97
MSE        |       79,975,377,567 |       79,558,276,798
R2         |               0.6603 |               0.6573
-----------------------------------------------------------------
Time       |                                    5.05 sec
=================================================================

21:00:14 - INFO - 
=================================================================
MODEL: XGBRegressor (Top-30 features)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           123,914.61 |           128,444.90
MSE        |       51,326,955,548 |       55,890,678,586
R2         |               0.7820 |               0.7593
-----------------------------------------------------------------
Time       |                                    1.60 sec
=================================================================

21:00:30 - INFO - 
=================================================================
MODEL: PIPELINE HistGradientBoostingRegressor (Baseline)
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           109,726.28 |           116,218.43
MSE        |       39,885,997,632 |       46,207,831,353
R2         |               0.8279 |               0.8007
-----------------------------------------------------------------
Time       |                                   13.83 sec
=================================================================

21:01:18 - INFO - 
Лучшие гиперпараметры (Optuna): {'n_estimators': 1335, 'max_depth': 7, 'learning_rate': 0.04593449147887123, 'subsample': 0.9549647171334581, 'colsample_bytree': 0.6517784060298563}
21:01:18 - INFO - 
Лучший R2 на тесте подбора гиперпараметров (Optuna): 0.7784320353356418
21:01:26 - INFO - 
=================================================================
MODEL: PIPELINE OPTUNA TUNED XGBOOST
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |            92,434.55 |           106,199.16
MSE        |       29,202,173,584 |       41,614,680,960
R2         |               0.8740 |               0.8205
-----------------------------------------------------------------
Time       |                                   56.39 sec
=================================================================

21:03:36 - INFO - 
=================================================================
MODEL: PIPELINE STACKING RF CatBoost(GPU) RIDGE
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           115,784.87 |           120,102.04
MSE        |       44,724,064,117 |       49,404,044,654
R2         |               0.8070 |               0.7869
-----------------------------------------------------------------
Time       |                                 2 min 9 sec
=================================================================

21:04:11 - INFO - 
=================================================================
MODEL: PIPELINE STACKING RF+histGB+Ridge
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |           127,296.01 |           129,881.71
MSE        |       52,853,531,959 |       55,381,227,341
R2         |               0.7719 |               0.7611
-----------------------------------------------------------------
Time       |                                   34.81 sec
=================================================================

21:15:36 - INFO - 
=================================================================
MODEL: PIPELINE STACKING Triple XGBoost
-----------------------------------------------------------------
Metric     |                Train |                 Test
-----------------------------------------------------------------
MAE        |            64,658.78 |            96,222.70
MSE        |       14,372,935,342 |       37,206,576,062
R2         |               0.9380 |               0.8395
-----------------------------------------------------------------
Time       |                               11 min 25 sec
=================================================================

21:15:42 - INFO - 
================================================================================
FINAL SUMMARY REPORT
--------------------------------------------------------------------------------
                                            Model  R2 Score (Train)  R2 Score (Test)  MAE (Train)  MAE (Test)  MSE (Train)   MSE (Test) Execution Time
                 PIPELINE STACKING Triple XGBoost             0.938            0.840      64659.0     96223.0 1.437294e+10 3.720658e+10  11 min 25 sec
                    PIPELINE OPTUNA TUNED XGBOOST             0.874            0.820      92435.0    106199.0 2.920217e+10 4.161468e+10      56.39 sec
PIPELINE HistGradientBoostingRegressor (Baseline)             0.828            0.801     109726.0    116218.0 3.988600e+10 4.620783e+10      13.83 sec
         PIPELINE STACKING RF CatBoost(GPU) RIDGE             0.807            0.787     115785.0    120102.0 4.472406e+10 4.940404e+10    2 min 9 sec
                PIPELINE STACKING RF+histGB+Ridge             0.772            0.761     127296.0    129882.0 5.285353e+10 5.538123e+10      34.81 sec
              CatBoostRegressor (Top-30 features)             0.778            0.760     125728.0    128855.0 5.216533e+10 5.563557e+10       4.22 sec
                 CatBoostRegressor (All features)             0.777            0.760     126097.0    129295.0 5.238474e+10 5.574872e+10       4.28 sec
                   XGBRegressor (Top-30 features)             0.782            0.759     123915.0    128445.0 5.132696e+10 5.589068e+10       1.60 sec
          RandomForestRegressor (Top-30 features)             0.762            0.701     140327.0    152104.0 5.594443e+10 6.931194e+10      10.77 sec
  HistGradientBoostingRegressor (Top-30 features)             0.660            0.657     162463.0    161985.0 7.997538e+10 7.955828e+10       5.05 sec
          RandomForestRegressor (Top-16 features)             0.709            0.613     151322.0    170935.0 6.849324e+10 8.978407e+10       6.46 sec
              CatBoostRegressor (Top-16 features)             0.620            0.606     172928.0    174534.0 8.955005e+10 9.146289e+10       4.23 sec
  DecisionTreeRegressor (Elbow method depth = 13)             0.619            0.539     175870.0    189885.0 8.975253e+10 1.070691e+11       0.51 sec
  HistGradientBoostingRegressor (Top-16 features)             0.527            0.527     199104.0    197921.0 1.113094e+11 1.097383e+11       4.32 sec
          DecisionTreeRegressor (Top-16 features)             0.865            0.497      66383.0    172799.0 3.170121e+10 1.168120e+11       0.92 sec
                      LinearRegression (baseline)             0.302            0.306     260094.0    258703.0 1.643431e+11 1.611475e+11       0.03 sec
               LinearRegression (Top-16 features)             0.239            0.243     273048.0    271612.0 1.792749e+11 1.758225e+11       0.04 sec
--------------------------------------------------------------------------------
Total Execution Time: 19 min 36 sec
================================================================================

