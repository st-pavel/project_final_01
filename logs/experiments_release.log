20:40:47 - INFO - Старт сессии
20:40:47 - INFO - 
=================================================================
SYSTEM CONFIGURATION
-----------------------------------------------------------------
Date:   2025-12-26 20:40:47
OS:     Linux 6.17.0-1008-oem (#8-Ubuntu SMP PREEMPT_DYNAMIC Wed Dec 10 05:19:21 UTC 2025)
Python: 3.12.3
CPU:    x86_64 (22 cores)
RAM:    93.91 GB
GPU:    NVIDIA GeForce RTX 4060 Laptop GPU (7.63 GB VRAM)
=================================================================

20:40:50 - INFO - DATASET LOADED: ./data/data.csv.zip
SHAPE: 377185 rows x 18 columns | MEMORY: 595.6 MB
MISSING: 1869153 cells (27.5% of all values)
20:42:05 - INFO - Интерактивный отчет D-Tale доступен по ссылке: http://0.0.0.0:40000/dtale/main/1
20:42:07 - INFO - 
======================================================================
MODEL: LinearRegression (baseline)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             260,093.71 |             258,702.98
MSE        |        164,343,123,678 |        161,147,514,384
R2         |                 0.3019 |                 0.3059
MAPE       |                 91.95% |                 92.14%
MdAPE      |                 48.97% |                 49.27%
----------------------------------------------------------------------
Time       |                                        0.04 sec
======================================================================

20:42:17 - INFO - Оптимальное количество признаков по RFECV: 16
20:42:17 - INFO - Отобранные признаки: ['baths', 'zipcode', 'latitude', 'longitude', 'sqft', 'stories', 'beds', 'lotsize', 'age', 'rating_mean', 'distance_mean', 'schools_count', 'status_for sale', 'propertyType_coop', 'propertyType_land', 'propertyType_single family']
20:42:17 - INFO - 
======================================================================
MODEL: LinearRegression (Top-16 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             273,048.10 |             271,611.81
MSE        |        179,274,918,370 |        175,822,519,868
R2         |                 0.2385 |                 0.2427
MAPE       |                 94.91% |                 94.97%
MdAPE      |                 53.11% |                 53.27%
----------------------------------------------------------------------
Time       |                                        0.03 sec
======================================================================

20:42:18 - INFO - 
======================================================================
MODEL: DecisionTreeRegressor (Top-16 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |              66,382.75 |             172,798.91
MSE        |         31,701,211,805 |        116,812,000,156
R2         |                 0.8653 |                 0.4969
MAPE       |                 19.52% |                 47.72%
MdAPE      |                  2.62% |                 21.71%
----------------------------------------------------------------------
Time       |                                        0.89 sec
======================================================================

20:42:23 - INFO - Выбрана оптимальная глубина дерева (с учетом допуска): 13 (R2: 0.631)
20:42:23 - INFO - 
======================================================================
MODEL: DecisionTreeRegressor (Elbow method depth = 13)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             175,869.82 |             189,885.30
MSE        |         89,752,527,129 |        107,069,066,757
R2         |                 0.6188 |                 0.5388
MAPE       |                 59.22% |                 61.49%
MdAPE      |                 30.44% |                 31.98%
----------------------------------------------------------------------
Time       |                                        0.49 sec
======================================================================

20:42:30 - INFO - 
======================================================================
MODEL: RandomForestRegressor (Top-16 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             151,322.21 |             170,934.62
MSE        |         68,493,243,719 |         89,784,069,197
R2         |                 0.7091 |                 0.6133
MAPE       |                 50.99% |                 54.99%
MdAPE      |                 25.49% |                 27.80%
----------------------------------------------------------------------
Time       |                                        6.23 sec
======================================================================

20:42:34 - INFO - 
======================================================================
MODEL: HistGradientBoostingRegressor (Top-16 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             199,103.78 |             197,921.01
MSE        |        111,309,408,475 |        109,738,343,654
R2         |                 0.5272 |                 0.5273
MAPE       |                 67.64% |                 67.65%
MdAPE      |                 34.86% |                 34.82%
----------------------------------------------------------------------
Time       |                                        4.54 sec
======================================================================

20:42:40 - INFO - 
======================================================================
MODEL: CatBoostRegressor (Top-16 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             172,927.94 |             174,533.88
MSE        |         89,550,052,377 |         91,462,894,845
R2         |                 0.6196 |                 0.6060
MAPE       |                 55.29% |                 55.87%
MdAPE      |                 28.22% |                 28.58%
----------------------------------------------------------------------
Time       |                                        5.23 sec
======================================================================

20:42:45 - INFO - 
======================================================================
MODEL: CatBoostRegressor (All features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             126,097.26 |             129,294.69
MSE        |         52,384,738,276 |         55,748,715,395
R2         |                 0.7775 |                 0.7599
MAPE       |                 38.11% |                 39.02%
MdAPE      |                 19.65% |                 20.01%
----------------------------------------------------------------------
Time       |                                        5.06 sec
======================================================================

20:42:47 - INFO - Отобрано признаков с помощью CatBoost: 30
20:42:47 - INFO - Список признаков: ['baths', 'zipcode', 'latitude', 'longitude', 'sqft', 'stories', 'beds', 'lotsize', 'age', 'rating_mean', 'distance_mean', 'schools_count', 'status_for sale', 'status_foreclosure', 'status_new construction', 'status_other', 'propertyType_coop', 'propertyType_high rise', 'propertyType_land', 'propertyType_multi family', 'propertyType_other', 'propertyType_single family', 'propertyType_townhouse', 'propertyType_traditional', 'heating_central', 'heating_forced air', 'heating_other', 'cooling_central air', 'cooling_cooling', 'parking_detached']
20:42:52 - INFO - 
======================================================================
MODEL: CatBoostRegressor (Top-30 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             125,728.43 |             128,855.11
MSE        |         52,165,331,701 |         55,635,568,867
R2         |                 0.7784 |                 0.7604
MAPE       |                 37.97% |                 38.82%
MdAPE      |                 19.56% |                 19.89%
----------------------------------------------------------------------
Time       |                                        4.72 sec
======================================================================

20:43:02 - INFO - 
======================================================================
MODEL: RandomForestRegressor (Top-30 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             140,327.42 |             152,104.47
MSE        |         55,944,428,080 |         69,311,937,120
R2         |                 0.7624 |                 0.7015
MAPE       |                 49.79% |                 51.83%
MdAPE      |                 24.56% |                 25.86%
----------------------------------------------------------------------
Time       |                                       10.47 sec
======================================================================

20:43:07 - INFO - 
======================================================================
MODEL: HistGradientBoostingRegressor (Top-30 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             162,462.83 |             161,984.97
MSE        |         79,975,377,567 |         79,558,276,798
R2         |                 0.6603 |                 0.6573
MAPE       |                 53.26% |                 53.46%
MdAPE      |                 26.85% |                 26.82%
----------------------------------------------------------------------
Time       |                                        4.82 sec
======================================================================

20:44:58 - INFO - 
======================================================================
MODEL: XGBRegressor (Top-30 features)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             123,914.61 |             128,444.90
MSE        |         51,326,955,548 |         55,890,678,586
R2         |                 0.7820 |                 0.7593
MAPE       |                 37.31% |                 38.48%
MdAPE      |                 19.11% |                 19.68%
----------------------------------------------------------------------
Time       |                                        1.48 sec
======================================================================

20:45:13 - INFO - 
======================================================================
MODEL: PIPELINE HistGradientBoostingRegressor (Baseline)
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             109,726.28 |             116,218.43
MSE        |         39,885,997,632 |         46,207,831,353
R2         |                 0.8279 |                 0.8007
MAPE       |                 31.80% |                 32.89%
MdAPE      |                 17.10% |                 17.68%
----------------------------------------------------------------------
Time       |                                       12.96 sec
======================================================================

20:46:04 - INFO - 
Лучшие гиперпараметры (Optuna): {'n_estimators': 1533, 'max_depth': 8, 'learning_rate': 0.03892340476973688, 'subsample': 0.7335285813109776, 'colsample_bytree': 0.6295650978393845}
20:46:04 - INFO - 
Лучший R2 на тесте подбора гиперпараметров (Optuna): 0.7776861154255922
20:46:15 - INFO - 
======================================================================
MODEL: PIPELINE OPTUNA TUNED XGBOOST
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |              82,335.57 |             102,663.64
MSE        |         22,667,193,036 |         39,695,046,434
R2         |                 0.9022 |                 0.8288
MAPE       |                 24.63% |                 28.17%
MdAPE      |                 13.20% |                 14.80%
----------------------------------------------------------------------
Time       |                                     1 min 2 sec
======================================================================

20:48:10 - INFO - 
======================================================================
MODEL: PIPELINE STACKING RF CatBoost(GPU) RIDGE
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             116,113.20 |             120,411.68
MSE        |         44,911,051,816 |         49,597,432,357
R2         |                 0.8062 |                 0.7861
MAPE       |                 33.12% |                 33.94%
MdAPE      |                 17.93% |                 18.16%
----------------------------------------------------------------------
Time       |                                    1 min 54 sec
======================================================================

20:48:41 - INFO - 
======================================================================
MODEL: PIPELINE STACKING RF+histGB+Ridge
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |             127,296.01 |             129,881.71
MSE        |         52,853,531,959 |         55,381,227,341
R2         |                 0.7719 |                 0.7611
MAPE       |                 36.87% |                 37.29%
MdAPE      |                 19.73% |                 19.97%
----------------------------------------------------------------------
Time       |                                       30.14 sec
======================================================================

21:00:06 - INFO - 
======================================================================
MODEL: PIPELINE STACKING Triple XGBoost
----------------------------------------------------------------------
Metric     |                  Train |                   Test
----------------------------------------------------------------------
MAE        |              64,658.78 |              96,222.70
MSE        |         14,372,935,342 |         37,206,576,062
R2         |                 0.9380 |                 0.8395
MAPE       |                 20.08% |                 25.81%
MdAPE      |                 10.76% |                 13.53%
----------------------------------------------------------------------
Time       |                                   11 min 25 sec
======================================================================

21:00:11 - INFO - 
====================================================================================================
FINAL SUMMARY REPORT
----------------------------------------------------------------------------------------------------
                                            Model  R2 (Test)  MAE (Test)  MAPE (Test, %)  MdAPE (Test, %)  R2 (Train)   MSE (Test) Execution Time
                 PIPELINE STACKING Triple XGBoost     0.8395     96223.0           25.81            13.53      0.9380 3.720658e+10  11 min 25 sec
                    PIPELINE OPTUNA TUNED XGBOOST     0.8288    102664.0           28.17            14.80      0.9022 3.969505e+10    1 min 2 sec
PIPELINE HistGradientBoostingRegressor (Baseline)     0.8007    116218.0           32.89            17.68      0.8279 4.620783e+10      12.96 sec
         PIPELINE STACKING RF CatBoost(GPU) RIDGE     0.7861    120412.0           33.94            18.16      0.8062 4.959743e+10   1 min 54 sec
                PIPELINE STACKING RF+histGB+Ridge     0.7611    129882.0           37.29            19.97      0.7719 5.538123e+10      30.14 sec
              CatBoostRegressor (Top-30 features)     0.7604    128855.0           38.82            19.89      0.7784 5.563557e+10       4.72 sec
                 CatBoostRegressor (All features)     0.7599    129295.0           39.02            20.01      0.7775 5.574872e+10       5.06 sec
                   XGBRegressor (Top-30 features)     0.7593    128445.0           38.48            19.68      0.7820 5.589068e+10       1.48 sec
          RandomForestRegressor (Top-30 features)     0.7015    152104.0           51.83            25.86      0.7624 6.931194e+10      10.47 sec
  HistGradientBoostingRegressor (Top-30 features)     0.6573    161985.0           53.46            26.82      0.6603 7.955828e+10       4.82 sec
          RandomForestRegressor (Top-16 features)     0.6133    170935.0           54.99            27.80      0.7091 8.978407e+10       6.23 sec
              CatBoostRegressor (Top-16 features)     0.6060    174534.0           55.87            28.58      0.6196 9.146289e+10       5.23 sec
  DecisionTreeRegressor (Elbow method depth = 13)     0.5388    189885.0           61.49            31.98      0.6188 1.070691e+11       0.49 sec
  HistGradientBoostingRegressor (Top-16 features)     0.5273    197921.0           67.65            34.82      0.5272 1.097383e+11       4.54 sec
          DecisionTreeRegressor (Top-16 features)     0.4969    172799.0           47.72            21.71      0.8653 1.168120e+11       0.89 sec
                      LinearRegression (baseline)     0.3059    258703.0           92.14            49.27      0.3019 1.611475e+11       0.04 sec
               LinearRegression (Top-16 features)     0.2427    271612.0           94.97            53.27      0.2385 1.758225e+11       0.03 sec
----------------------------------------------------------------------------------------------------
Total Execution Time: 19 min 24 sec
====================================================================================================

